Version 4
SHEET 1 3300 1052
WIRE 528 -304 528 -336
WIRE 1072 -288 1056 -288
WIRE 1232 -288 1216 -288
WIRE 1792 -288 1776 -288
WIRE 1952 -288 1936 -288
WIRE 1360 -224 1360 -288
WIRE 1648 -224 1648 -288
WIRE 1056 -208 1056 -288
WIRE 1152 -208 1056 -208
WIRE 1232 -208 1232 -288
WIRE 1248 -208 1232 -208
WIRE 1312 -208 1248 -208
WIRE 1760 -208 1696 -208
WIRE 1776 -208 1776 -288
WIRE 1776 -208 1760 -208
WIRE 1952 -208 1952 -288
WIRE 1952 -208 1856 -208
WIRE 2576 -208 2352 -208
WIRE 1248 -176 1248 -208
WIRE 1760 -176 1760 -208
WIRE 2352 -160 2352 -208
WIRE 2576 -160 2576 -208
WIRE 1360 -112 1360 -128
WIRE 1424 -112 1360 -112
WIRE 1456 -112 1424 -112
WIRE 1584 -112 1536 -112
WIRE 1648 -112 1648 -128
WIRE 1648 -112 1584 -112
WIRE 1248 -96 1248 -112
WIRE 1360 -96 1360 -112
WIRE 1360 -96 1248 -96
WIRE 1648 -96 1648 -112
WIRE 1760 -96 1760 -112
WIRE 1760 -96 1648 -96
WIRE 1424 -32 1424 -112
WIRE 1456 -32 1424 -32
WIRE 1584 -32 1584 -112
WIRE 1584 -32 1536 -32
WIRE 1056 -16 1056 -208
WIRE 1216 -16 1200 -16
WIRE 1360 -16 1360 -96
WIRE 1648 -16 1648 -96
WIRE 1808 -16 1792 -16
WIRE 1952 -16 1952 -208
WIRE 2352 -16 2352 -80
WIRE 2576 -16 2576 -80
WIRE 2576 -16 2352 -16
WIRE 832 64 752 64
WIRE 1056 64 1056 -16
WIRE 1056 64 832 64
WIRE 1136 64 1056 64
WIRE 1216 64 1216 -16
WIRE 1248 64 1248 -32
WIRE 1248 64 1216 64
WIRE 1312 64 1248 64
WIRE 1760 64 1760 -32
WIRE 1760 64 1696 64
WIRE 1792 64 1792 -16
WIRE 1792 64 1760 64
WIRE 1952 64 1952 -16
WIRE 1952 64 1872 64
WIRE 2048 64 1952 64
WIRE 2128 64 2048 64
WIRE 2576 64 2576 -16
WIRE 832 128 832 64
WIRE 960 128 944 128
WIRE 1008 128 960 128
WIRE 1360 128 1360 80
WIRE 1648 128 1648 80
FLAG 1360 128 0
FLAG 528 -224 0
FLAG 528 -336 VCC
FLAG 1360 -288 VCC
FLAG 752 144 0
FLAG 960 128 drive1
FLAG 1648 128 0
FLAG 1648 -288 VCC
FLAG 2048 64 drive1
FLAG 2576 64 0
SYMBOL nmos 1312 -16 R0
SYMATTR InstName M2
SYMATTR Value IRFP240
SYMBOL pmos 1312 -128 M180
SYMATTR InstName M4
SYMATTR Value IRFP9240
SYMBOL res 1248 -224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 2k
SYMBOL diode 1216 -304 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMBOL res 1232 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 2k
SYMBOL diode 1136 0 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D12
SYMBOL cap 1232 -176 R0
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL cap 1264 -32 R180
WINDOW 0 -36 32 Left 2
WINDOW 3 -39 4 Left 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL voltage 528 -320 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 5
SYMATTR InstName V5
SYMBOL voltage 752 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -271 -43 Left 2
WINDOW 0 -23 -10 Left 2
SYMATTR Value PULSE(0 5 0 100n 100n 0.2ms 0.4ms 14)
SYMATTR InstName VIN1
SYMBOL 74hc04 880 64 R0
SYMATTR InstName U1
SYMBOL nmos 1696 -16 M0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL pmos 1696 -128 R180
SYMATTR InstName M3
SYMATTR Value IRFP9240
SYMBOL res 1760 -224 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 2k
SYMBOL diode 1792 -304 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMBOL res 1776 48 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL diode 1872 0 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL cap 1776 -176 M0
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL cap 1744 -32 M180
WINDOW 0 -36 32 Left 2
WINDOW 3 -39 4 Left 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL ind2 1552 -128 R90
WINDOW 0 4 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 1m
SYMATTR Type ind
SYMBOL res 2592 -176 M0
SYMATTR InstName R1
SYMATTR Value 200R
SYMBOL ind2 2368 -64 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 32m
SYMATTR Type ind
SYMBOL res 1168 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 1152 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 1952 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 1968 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
TEXT -104 -288 Left 2 !.tran 3ms
TEXT -136 -176 Left 2 !.include my.lib
TEXT -136 -144 Left 2 !.include standard.bjt
TEXT -128 -96 Left 2 !.include 74hc.lib
TEXT 2384 -312 Left 2 !K  L1 L2 0.99
TEXT 1696 -576 Left 2 ;It seems better with diodes in opposite direction to what we expect
TEXT 1696 -496 Left 2 ;but is there cross-conduction?
TEXT 1688 -464 Left 2 ;note when load is increased by increasing L2. the waveform is less good.

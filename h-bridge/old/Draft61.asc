Version 4
SHEET 1 3300 1956
WIRE 608 -288 464 -288
WIRE 2720 -208 2496 -208
WIRE 1008 -192 832 -192
WIRE 1072 -192 1008 -192
WIRE 1200 -192 1072 -192
WIRE 1344 -192 1200 -192
WIRE 1872 -192 1728 -192
WIRE 1968 -192 1872 -192
WIRE 2064 -192 1968 -192
WIRE 2240 -192 2064 -192
WIRE 832 -160 832 -192
WIRE 1344 -160 1344 -192
WIRE 1728 -160 1728 -192
WIRE 2240 -160 2240 -192
WIRE 2496 -160 2496 -208
WIRE 2720 -160 2720 -208
WIRE 1008 -112 896 -112
WIRE 1280 -112 1200 -112
WIRE 1872 -112 1792 -112
WIRE 2176 -112 2064 -112
WIRE 944 -64 832 -64
WIRE 2240 -64 2128 -64
WIRE 2496 -16 2496 -80
WIRE 2720 -16 2720 -80
WIRE 2720 -16 2496 -16
WIRE 1200 48 1200 -112
WIRE 1872 48 1872 -112
WIRE 2720 64 2720 -16
WIRE 1008 96 1008 -16
WIRE 1136 96 1008 96
WIRE 2064 96 2064 -16
WIRE 2064 96 1936 96
WIRE 1344 144 1344 -64
WIRE 1344 144 1200 144
WIRE 1728 144 1728 -64
WIRE 1872 144 1728 144
WIRE 368 160 320 160
WIRE 464 160 432 160
WIRE 560 160 528 160
WIRE 1008 176 1008 160
WIRE 128 192 0 192
WIRE 1344 224 1344 144
WIRE 1456 224 1344 224
WIRE 1504 224 1456 224
WIRE 1664 224 1584 224
WIRE 1728 224 1728 144
WIRE 1728 224 1664 224
WIRE 0 272 0 192
WIRE 32 272 0 272
WIRE 128 288 128 192
WIRE 128 288 96 288
WIRE 224 288 128 288
WIRE 320 288 320 160
WIRE 320 288 304 288
WIRE 384 288 320 288
WIRE 560 288 560 160
WIRE 560 288 448 288
WIRE 752 288 560 288
WIRE 2224 288 2208 288
WIRE 2352 288 2304 288
WIRE 2400 288 2352 288
WIRE -160 304 -240 304
WIRE -80 304 -96 304
WIRE -32 304 -80 304
WIRE 32 304 -32 304
WIRE -80 368 -80 304
WIRE 1344 368 1344 224
WIRE 1344 368 1200 368
WIRE 1728 368 1728 224
WIRE 1872 368 1728 368
WIRE 320 400 320 288
WIRE 352 400 320 400
WIRE 2352 400 2352 288
WIRE 2352 400 2320 400
WIRE 1008 416 1008 240
WIRE 1008 416 416 416
WIRE 1104 416 1008 416
WIRE 1136 416 1104 416
WIRE 1968 416 1936 416
WIRE 2064 416 2064 224
WIRE 2064 416 1968 416
WIRE 2256 416 2064 416
WIRE 352 432 320 432
WIRE 2368 480 2320 432
WIRE 1104 496 1104 416
WIRE 1968 496 1968 416
WIRE 1344 512 1344 368
WIRE 1728 512 1728 368
WIRE 1200 560 1200 464
WIRE 1200 560 1104 560
WIRE 1280 560 1200 560
WIRE 1872 560 1872 464
WIRE 1872 560 1792 560
WIRE 1968 560 1872 560
WIRE 1056 640 1008 640
WIRE 1200 640 1056 640
WIRE 1344 640 1344 608
WIRE 1344 640 1200 640
WIRE 1728 640 1728 608
WIRE 1872 640 1728 640
WIRE 2000 640 1872 640
WIRE 2112 640 2000 640
FLAG 464 -368 VCC
FLAG 1456 224 PRIM1
FLAG -240 384 0
FLAG 1072 -192 VCC
FLAG 752 288 PRIM1
FLAG 608 -288 0
FLAG 320 432 0
FLAG 384 384 VCC
FLAG 1664 224 PRIM2
FLAG 1968 -192 VCC
FLAG 2288 384 VCC
FLAG 2368 480 0
FLAG 2720 64 0
FLAG 464 -208 VEE
FLAG 1056 640 VEE
FLAG 2000 640 VEE
FLAG 384 448 VEE
FLAG 2288 448 VEE
FLAG 832 16 VEE
FLAG 2240 16 VEE
FLAG 2208 288 PRIM1
FLAG 2480 288 PRIM2
FLAG 64 256 VCC
FLAG 64 320 VEE
FLAG -80 448 0
FLAG -32 304 XXX
SYMBOL pnp 944 -16 M180
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL pnp 896 -64 R180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL res 1024 -208 M0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL voltage 464 -384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 8
SYMATTR InstName V1
SYMBOL res 848 -80 M0
SYMATTR InstName R8
SYMATTR Value 20k
SYMBOL npn 1136 48 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL pnp 1136 464 M180
SYMATTR InstName Q6
SYMATTR Value 2N3906
SYMBOL voltage -240 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -394 165 Left 2
WINDOW 0 -23 -10 Left 2
SYMATTR Value PULSE(0 3.3 0 100n 100n 0.2ms 0.4ms 28)
SYMATTR InstName VIN1
SYMBOL res 208 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 2k
SYMBOL diode 992 96 R0
SYMATTR InstName D1
SYMBOL diode 992 176 R0
SYMATTR InstName D2
SYMBOL cap 448 272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 5n
SYMBOL res 1184 -208 R0
SYMATTR InstName R3
SYMATTR Value 270
SYMBOL res 1184 544 R0
SYMATTR InstName R4
SYMATTR Value 270
SYMBOL pnp 1280 -64 M180
SYMATTR InstName Q10
SYMATTR Value MJE15035
SYMBOL npn 1280 512 R0
SYMATTR InstName Q11
SYMATTR Value MJE15034
SYMBOL OpAmps\\LT1006 384 352 R0
SYMATTR InstName U1
SYMBOL pnp 2128 -16 R180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL pnp 2176 -64 M180
SYMATTR InstName Q4
SYMATTR Value 2N3906
SYMBOL res 2048 -208 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 2224 -80 R0
SYMATTR InstName R2
SYMATTR Value 20k
SYMBOL npn 1936 48 M0
SYMATTR InstName Q7
SYMATTR Value 2N3904
SYMBOL pnp 1936 464 R180
SYMATTR InstName Q8
SYMATTR Value 2N3906
SYMBOL res 2496 304 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 5k
SYMBOL diode 2080 96 M0
SYMATTR InstName D3
SYMBOL diode 2080 160 M0
SYMATTR InstName D4
SYMBOL res 1888 -208 M0
SYMATTR InstName R13
SYMATTR Value 270
SYMBOL res 1888 544 M0
SYMATTR InstName R15
SYMATTR Value 270
SYMBOL pnp 1792 -64 R180
SYMATTR InstName Q9
SYMATTR Value MJE15035
SYMBOL npn 1792 512 M0
SYMATTR InstName Q12
SYMATTR Value MJE15034
SYMBOL res 2736 -176 M0
SYMATTR InstName R16
SYMATTR Value 200R
SYMBOL OpAmps\\LT1006 2288 352 M0
SYMATTR InstName U2
SYMBOL res 2320 304 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 5k
SYMBOL ind2 1600 208 R90
WINDOW 0 4 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 1m
SYMATTR Type ind
SYMBOL ind2 2512 -64 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L2
SYMATTR Value 8m
SYMATTR Type ind
SYMBOL voltage 464 -304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 42 41 Left 2
SYMATTR Value 8
SYMATTR InstName V2
SYMBOL zener 432 144 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D5
SYMATTR Value 1N750
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL zener 464 176 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMATTR Value 1N750
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL OpAmps\\LT1006 64 224 R0
SYMATTR InstName U3
SYMBOL cap -96 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res -96 352 R0
SYMATTR InstName R5
SYMATTR Value 5k
TEXT 688 -392 Left 2 !.tran 12ms
TEXT 240 392 Left 2 ;plus
TEXT -232 544 Left 2 ;input 0-3v3 square wave input.\nfrom mcu/ oscillator etc
TEXT 240 -88 Left 2 !.include standard.bjt
TEXT 2432 392 Right 2 ;plus
TEXT 984 -576 Left 2 ;- still have issue of potential flux walk\n- consider add protective diodes, across output bjt.\n- consider remove 0.1R. emitter degenerators\n -consider series resistor with output of bjt.\n- advantage of op-amp, can also drive with pure sine-wave
TEXT 2480 -312 Left 2 !K  L1 L2 0.99
TEXT 2280 192 Left 2 ;ie. inverter
TEXT 400 848 Left 2 ;https://sound-au.com/articles/cmpd-vs-darl.htm
TEXT 2048 -464 Left 2 ;need to try,  with two inverter configuration, and bypass level.\n \nalso try lo nmos hi /pmos . should be possible with square wave. \nand diodes for fast switch off
TEXT -528 -80 Left 2 ;can't make this work very well\ni think diodes across integrator just doesn't work \nit's not like a slope amp\nBUT - if we had a follower inverting op with diodes- then that won't work either.
TEXT -200 104 Left 2 !# ! .ic V(XXX )=0
